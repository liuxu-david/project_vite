{"version":3,"file":"index-DoFfd3wg.js","sources":["../../src/views/list/index.vue"],"sourcesContent":["<script setup>\r\n  import { computed, onMounted, reactive, ref } from \"vue\";\r\n\r\n  // 数据定义\r\n  const listRef = ref(null); //用于获取可视区域高度\r\n  let scrollTop = ref(0); //滚动高度\r\n  let viewHeight = 0; //可视区域的高度\r\n  let itemHeight = 30; //每项固定高度\r\n  let itemSum = ref(0); //展示条数\r\n  let startIndex = ref(0); //起始索引\r\n\r\n  // 后端返回的数据\r\n  const data = [];\r\n  for (let i = 1; i <= 200; i++) {\r\n    data.push({ id: i, content: `列表${i}` });\r\n  }\r\n  // 计算属性\r\n  const handleListResult = computed(() => {\r\n    const endIndex = startIndex.value + itemSum.value;\r\n    endIndex > data.length ? data.length : endIndex;\r\n    const result = data.slice(startIndex.value, endIndex);\r\n    console.log(result);\r\n    console.log(startIndex.value, endIndex);\r\n    return result;\r\n  });\r\n  // 数据监听\r\n  // 生命周期钩子\r\n  onMounted(() => {\r\n    viewHeight = listRef.value.offsetHeight;\r\n    itemSum.value = Math.ceil(viewHeight / itemHeight);\r\n  });\r\n\r\n  // 方法处理\r\n  const handleListScroll = () => {\r\n    scrollTop.value = listRef.value.scrollTop;\r\n    startIndex.value = Math.floor(scrollTop.value / itemHeight);\r\n  };\r\n  const throttle = (fn, dalay) => {\r\n    let timer = null;\r\n    return function (...agrgs) {\r\n      if (timer) return;\r\n      timer = setTimeout(() => {\r\n        fn.apply(this, agrgs);\r\n        timer = null;\r\n      }, dalay);\r\n    };\r\n  };\r\n  const handleThrottleScroll = throttle(handleListScroll, 100);\r\n</script>\r\n\r\n<template>\r\n  <div class=\"list\" @scroll=\"handleThrottleScroll\" ref=\"listRef\">\r\n    <div :style=\"{ height: `${itemHeight * data.length}px` }\">\r\n      <ul\r\n        :style=\"{\r\n          transform: `translateY(${startIndex * itemHeight}px)`,\r\n        }\"\r\n      >\r\n        <li class=\"list_item\" v-for=\"item in handleListResult\" :key=\"item.id\">\r\n          {{ item.content }}\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n  .list {\r\n    width: 310px;\r\n    height: 320px;\r\n    border: 1px solid red;\r\n    overflow-y: scroll;\r\n\r\n    .list_item {\r\n      height: 30px;\r\n      width: 300px;\r\n      border: 1px solid green;\r\n      margin-left: -40px;\r\n      list-style: none;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n    }\r\n  }\r\n</style>\r\n"],"names":["listRef","ref","scrollTop","viewHeight","itemHeight","itemSum","startIndex","data","i","handleListResult","computed","endIndex","result","onMounted","handleThrottleScroll","fn","dalay","timer","agrgs"],"mappings":"iJAIE,MAAMA,EAAUC,EAAI,IAAI,EACxB,IAAIC,EAAYD,EAAI,CAAC,EACjBE,EAAa,EACbC,EAAa,GACbC,EAAUJ,EAAI,CAAC,EACfK,EAAaL,EAAI,CAAC,EAGtB,MAAMM,EAAO,CAAA,EACb,QAASC,EAAI,EAAGA,GAAK,IAAKA,IACxBD,EAAK,KAAK,CAAE,GAAIC,EAAG,QAAS,KAAKA,CAAC,EAAE,CAAE,EAGxC,MAAMC,EAAmBC,EAAS,IAAM,CACtC,MAAMC,EAAWL,EAAW,MAAQD,EAAQ,MAEtCO,EAASL,EAAK,MAAMD,EAAW,MAAOK,CAAQ,EACpD,eAAQ,IAAIC,CAAM,EAClB,QAAQ,IAAIN,EAAW,MAAOK,CAAQ,EAC/BC,CACX,CAAG,EAGDC,EAAU,IAAM,CACdV,EAAaH,EAAQ,MAAM,aAC3BK,EAAQ,MAAQ,KAAK,KAAKF,EAAaC,CAAU,CACrD,CAAG,EAiBD,MAAMU,GAVW,CAACC,EAAIC,IAAU,CAC9B,IAAIC,EAAQ,KACZ,OAAO,YAAaC,EAAO,CACrBD,IACJA,EAAQ,WAAW,IAAM,CACvBF,EAAG,MAAM,KAAMG,CAAK,EACpBD,EAAQ,IACT,EAAED,CAAK,EACd,CACA,GAb2B,IAAM,CAC7Bd,EAAU,MAAQF,EAAQ,MAAM,UAChCM,EAAW,MAAQ,KAAK,MAAMJ,EAAU,MAAQE,CAAU,CAC9D,EAW0D,GAAG"}